# การทดสอบระบบ MANTA

โฟลเดอร์นี้มีสคริปต์ทดสอบสำหรับส่วนประกอบต่างๆ ของระบบกล้อง MANTA

## การทดสอบกล้อง

### การทดสอบกล้องมาตรฐาน

สคริปต์ `camera/test_camera.py` ทดสอบการทำงานของกล้องโดยใช้ทั้งกล้องเว็บแคมมาตรฐานและโมดูลกล้องของ Raspberry Pi รองรับการแสดงผลและการจับภาพด้วย OpenCV

วิธีใช้:

```bash
cd tests
./camera/test_camera.py [ตัวเลือก]
```

ตัวเลือก:

- `--source SOURCE`: แหล่งกล้อง (0 สำหรับกล้องเว็บแคมเริ่มต้น หรือ URL/พาธไฟล์)
- `--width WIDTH`: ความกว้างของเฟรม (ค่าเริ่มต้น: 640)
- `--height HEIGHT`: ความสูงของเฟรม (ค่าเริ่มต้น: 480)
- `--fps FPS`: เฟรมต่อวินาที (ค่าเริ่มต้น: 30)
- `--frames FRAMES`: จำนวนเฟรมที่จะจับในการทดสอบพื้นฐาน (ค่าเริ่มต้น: 10)
- `--duration DURATION`: ระยะเวลาที่จะสตรีมเป็นวินาที (ค่าเริ่มต้น: 5)
- `--save DIRECTORY`: โฟลเดอร์ที่จะบันทึกเฟรมทดสอบ
- `--no-display`: ปิดการแสดงเฟรม
- `--test {all,webcam,picamera,streaming}`: การทดสอบที่จะรัน (ค่าเริ่มต้น: all)

### การทดสอบกล้อง Raspberry Pi

สคริปต์ `camera/test_pi_specific.py` ทดสอบคุณสมบัติเฉพาะของกล้อง Raspberry Pi เช่น โหมดการจับภาพต่างๆ การบันทึกวิดีโอ และการสตรีม

วิธีใช้:

```bash
cd tests
./camera/test_pi_specific.py [ตัวเลือก]
```

ตัวเลือก:

- `--test {all,basic,recording,advanced,streaming}`: การทดสอบที่จะรัน (ค่าเริ่มต้น: all)
- `--duration DURATION`: ระยะเวลาสำหรับการทดสอบการบันทึกเป็นวินาที (ค่าเริ่มต้น: 5)

## การทดสอบ Firebase

การทดสอบ Firebase อยู่ในโฟลเดอร์ `firebase/`:

- `firebase/test_firebase.py`: ทดสอบการเชื่อมต่อและการทำงานพื้นฐานของ Firebase
- `firebase/send_test_event.py`: จำลองเหตุการณ์การตรวจจับบุคคล

## การรันการทดสอบบน Raspberry Pi

เมื่อทดสอบบน Raspberry Pi ต้องแน่ใจว่าได้ติดตั้งการพึ่งพาที่จำเป็นแล้ว:

```bash
# ติดตั้ง OpenCV
sudo apt-get install python3-opencv

# ติดตั้ง PiCamera
sudo apt-get install python3-picamera

# ติดตั้งแพ็คเกจ Python เพิ่มเติม
pip3 install -r models/requirements.txt
```

สำหรับการทดสอบโมดูลกล้อง ต้องแน่ใจว่าเปิดใช้งานแล้ว:

```bash
sudo raspi-config
```

นำทางไปที่ "Interface Options" > "Camera" และเปิดใช้งาน

## ผลการทดสอบ

สคริปต์ทดสอบจะแสดงข้อมูลรายละเอียดเกี่ยวกับแต่ละขั้นตอนการทดสอบ รวมถึง:

- ✅ ตัวบ่งชี้ความสำเร็จ
- ❌ ตัวบ่งชี้ความล้มเหลว
- คุณสมบัติกล้องจริง (ความละเอียด อัตราเฟรม)
- การวัดประสิทธิภาพ
- รายละเอียดข้อผิดพลาด (ถ้ามี)

สำหรับการทดสอบภาพ เฟรมจะแสดงในหน้าต่างถ้าไม่ได้ใช้ตัวเลือก `--no-display`

ถ้าลงตัวเลือก `--save` เฟรมทดสอบจะถูกบันทึกลงในโฟลเดอร์ที่ระบุเพื่อการวิเคราะห์ในภายหลัง
